# The idx_finder node
## Overview
The `idx_finder` communicates to the spice_up_coordinator through the `FindIndex` service.
The idx_finder contains three modules:
* Cropper
* OCRLocalizer
* HistogramLocalizer

The following diagram gives an overview over the information flow:
![sa_slide_extraction-2](https://github.com/user-attachments/assets/dfa406e3-daf2-415a-a3bc-d2a7d2a0ce85)

## Cropper
The `index_finder_server` receives a `FindIndex` request, which contains a color-img, a mask and the information of whether or not the mask contains 5 contours or not (`has_five_contours`). If `has_five_contours == True`, the `all_bottles_mask` (mask containing four white blobs, one for each bottle) is generated by simple (inversion, bitwise_and) operations on the initial mask. If `has_five_contours == False`, the initial color img is thresholded and the resulting mask cleaned. Either way, at this point the `all_bottles_mask` exists. 

**Important: If the `all_bottles_mask` was obtained via thresholding, it is assumed that it only contains three blobs: vinegar, oil, salt. Pepper is assumed to have been suppressed by the thresholding.**  

Thus for the rest of the Cropper-pipeline, a distinction is made between thresholding-approach & 4-hole-approach, since they make different assumptions about how many blobs are present in the `all_bottles_mask`.
..
### 4-hole-approach
![sa_slide_extraction-4](https://github.com/user-attachments/assets/7e2f8815-7cf9-4dbe-9b8c-99bbe5e49744)
### Thresh-approach
![sa_slide_extraction-5](https://github.com/user-attachments/assets/04e27a41-a48c-42c6-9785-6dbbdc426fc0)

